- testTemplate:
    serviceFunctionName: usersService.createUser
    executeAfter: usersService.changeUserPassword
    argument:
      userName: test2@test.com
      displayName: test2
    response:
      statusCode: 200
      tests:
        - pm.collectionVariables.set('secondUserId', response._id)
  tests:
    - testName: 2nd user

- testTemplate:
    serviceFunctionName: usersService.followUser
    executeAfter: usersService.changeUserPassword
    argument:
      userId: '{{secondUserId}}'
    response:
      statusCode: 200
      tests:
        - pm.expect(response.followedUsers[0]._id).to.eql(pm.collectionVariables.get('secondUserId'))
  tests:
    - testName: ''

- testTemplate:
    serviceFunctionName: usersService.unfollowUser
    executeAfter: usersService.changeUserPassword
    argument:
      userId: '{{secondUserId}}'
    response:
      statusCode: 200
  tests:
    - testName: ''

- testTemplate:
    serviceFunctionName: usersService.getUserByUserName
    executeAfter: usersService.changeUserPassword
    argument:
      userName: test@test.com
    response:
      statusCode: 200
      tests:
        - pm.expect(response.followedUsers).to.eql([])
  tests:
    - testName: ''
